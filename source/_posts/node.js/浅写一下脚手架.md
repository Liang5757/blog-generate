---
title: 浅写一下脚手架
date: 2025-12-11 22:48:03
tags:
  - node.js
categories:
  - 前端工程化
---


## 处理用户命令

我们期望能像vue-cli一样用`vue create xxx`命令就能创建一个vue项目

为了能够解析用户命令，我们使用了[commander.js](https://github.com/tj/commander.js)库。

首先我们创建一个文件，路径为`./bin/index.ts`

```javascript
#! /usr/bin/env node
const { program } = require('commander');
const create = require('../script/create.ts');

program
  .command('create <name>')
  .description("创建项目")
  .action(name => {
    create(name);
  });

program.parse();
```

必须要加第一行`#! /usr/bin/env node`，将执行环境设置为node，否则会报错：[Node, when I run package.json \`bin\` \`command\` , give me \`syntax error near unexpected token \`\(\' \`](https://stackoverflow.com/questions/39585342/node-when-i-run-package-json-bin-command-give-me-syntax-error-near-unexp)

然后在package.json中增加如下配置

```json
"bin": {
  "op": "./bin/index.js"
},
```

最后执行`npm link`，将bin中的op命令注册成全局命令，这样我们就可以使用`op create`命令啦

## 支持查看版本

读取本地package.json中的version字段

```PHP
import packageJson from "../package.json" assert { type: "json" }; // esm模块方案引入json文件需要断言

program.version(packageJson.version, '-v, --version');
```

## 交互式命令行（inquirer）

如果不满足于command.js在一行内拼接大量参数的形式（开发者也记不住这么多参数的用法），可以用[Inquirer.js](https://github.com/SBoudrias/Inquirer.js)来做到交互式的命令行。

```js
new Inquirer.prompt([
  {
    name: "vue",
    // 多选交互功能
    // 单选将这里修改为 list 即可
    type: "checkbox",
    message: "Check the features needed for your project:",
    choices: [
      {
        name: "Babel",
        checked: true,
      },
      {
        name: "TypeScript",
      },
      {
        name: "Progressive Web App (PWA) Support",
      },
      {
        name: "Router",
      },
    ],
  },
]).then((data) => {
  console.log(data);
});
```

## 命令行 loading 效果（ora）



## 执行命令



## 五颜六色的命令行

## 参考

[【前端架构必备】手摸手带你搭建一个属于自己的脚手架](https://juejin.cn/post/7077717940941881358)